<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/e7cca994b7.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="assets/css/style.css">

    <title>Yoga Class Registration</title>
</head>

<body>

    <div class="enrollment-guidelines" id="guide" style="display:none;">
        <h3>ğŸ“Œ Enrollment Guidelines</h3>
        <ul>
            <li>âœ… Only individuals aged <strong>18-65</strong> can enroll.</li>
            <li>ğŸ’° The <strong>monthly fee is â‚¹500</strong>. Payment is required for the full month, even if
                enrolling
                late.</li>
            <li>ğŸ“… You can <strong>enroll anytime</strong>, but fees must be paid for the whole month.</li>
            <li>â³ You can <strong>choose any batch</strong> from the available slots:</li>
            <ul>
                <li>ğŸ•• 6:00 - 7:00 AM</li>
                <li>ğŸ•– 7:00 - 8:00 AM</li>
                <li>ğŸ•— 8:00 - 9:00 AM</li>
                <li>ğŸ•” 5:00 - 6:00 PM</li>
            </ul>
            <li>ğŸ”„ You can <strong>switch batches next month</strong>, but within a month, you must stay in the same
                batch.</li>
        </ul>
        <span><i class="far fa-times-circle"></i></span>
    </div>
    <div class="wrapper">
        <div class="image_div">
            <img src="assets/images/yoga.jpg" alt="" class="yoga_img">
        </div>
        <div class="form_div">
            <h2>Yoga Class Registration</h2>
            <form id="registrationForm" class="text-center">
                <div class="mb-4">
                    <!-- <label for="name" class="form-label">Name</label> -->
                    <input type="text" class="form-control" id="name" placeholder="Name" required>
                </div>
                <div class="mb-4">
                    <!-- <label for="email" class="form-label">Email</label> -->
                    <input type="email" class="form-control" id="email" placeholder="Email" required>
                </div>
                <div class="mb-4">
                    <!-- <label for="age" class="form-label">Age</label> -->
                    <input type="number" class="form-control" id="age" placeholder="Age" required>
                </div>
                <div class="mb-4">
                    <!-- <label for="phone" class="form-label">Phone</label> -->
                    <input type="tel" pattern="[0-9]{10}" inputmode="numeric" class="form-control" id="phone"
                        placeholder="Phone" required>
                </div>
                <div class="mb-4">
                    <input type="month" class="form-control" id="month" placeholder="Month" required>
                </div>
                <div class="mb-4">
                    <!-- <label for="batch" class="form-label">Batch</label> -->
                    <select id="batch" class="form-control" required>
                        <option disabled hidden selected value="">Select Batch</option>
                        <option value="6-7AM">6-7 AM</option>
                        <option value="7-8AM">7-8 AM</option>
                        <option value="8-9AM">8-9 AM</option>
                        <option value="5-6PM">5-6 PM</option>
                    </select>
                </div>
                <div class="mb-4 checkbox_div">
                    <input type="checkbox" id="agreement" required>
                    <label for="agreement">I agree to the terms. </label>
                    (<a href="#guide">View Guidelines</a>)
                </div>

                <button type="submit" class="btn btn-primary ">Register</button>
            </form>
        </div>
    </div>




    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>

        document.getElementById("registrationForm").addEventListener("submit", function (event) {
            event.preventDefault();


            // Age Validation
            let age_field = document.getElementById("age");

            let age = Number(age_field.value);
            let name = document.getElementById("name")
            let email = document.getElementById("email")
            let phone = document.getElementById("phone")
            let month = document.getElementById("month")
            let batch = document.getElementById("batch")
            let agreement = document.getElementById("agreement")

            if (age < 18 || age > 65 || isNaN(age)) {
                age_field.setCustomValidity("Only age between 18-65 are allowed");
                age_field.reportValidity();
                return;
            }


            let data = {
                name: name.value,
                email: email.value,
                age: age,
                phone: phone.value,
                month: formatMonthYear(month.value),
                batch: batch.value,
                agreement: agreement.checked
            };

            fetch("http://localhost/flexmoney-yoga-admission/api.php", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(data)
            })
                .then(response => response.json())
                .then(data => {
                    if (data.status) {
                        Swal.fire({
                            icon: "success",
                            title: "Success!",
                            text: data.message,
                        });

                        name.value = ""
                        email.value = ""
                        age_field.value = ""
                        phone.value = ""
                        batch.value = ""
                        month.value = ""
                        agreement.checked = false
                    } else {
                        Swal.fire({
                            icon: "error",
                            title: "Oops...",
                            text: data.message,
                        });
                    }
                })
                .catch(error => console.error("Error:", error));
        });


        document.getElementById("age").addEventListener("input", function () {
            this.setCustomValidity("");
        });

        // Set current year and month
        let today = new Date();
        let currentMonth = today.toISOString().slice(0, 7); // Format: YYYY-MM
        document.getElementById("month").setAttribute("min", currentMonth);

        function formatMonthYear(dateString) {
            let date = new Date(dateString + "-01"); // Append "-01" to avoid timezone issues
            let options = { year: "numeric", month: "long" };
            return date.toLocaleDateString("en-US", options);
        }

        // View Guidelines
        document.querySelector(".checkbox_div a").addEventListener('click', (e) => {
            let guidelines = document.querySelector(".enrollment-guidelines");
            // console.log(guidelines);
            guidelines.style.display = (guidelines.style.display === "none") ? "block" : "none";
        })

        // Close Giodeline Tab
        document.querySelector(".enrollment-guidelines span").addEventListener('click', (e) => {
            let guidelines = document.querySelector(".enrollment-guidelines");
            guidelines.style.display = "none";
        })
    </script>
</body>

</html>